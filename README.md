# Nutrition Estimation via Segmentation and Depth

## Overview
This project provides a Dockerized environment for machine learning and data analysis, leveraging PyTorch, TensorFlow, Jupyter Notebook, and various libraries for image processing and visualization. The setup is optimized for CUDA 11.1, making it compatible with NVIDIA GPUs.

- **Last Updated**: 03:54 PM +07, Tuesday, July 01, 2025
- **Environment**: Python 3.7, Jupyter Notebook, PyTorch 1.8.1

## Prerequisites
- Docker installed on your system (version 20.10 or higher recommended).
- NVIDIA GPU with CUDA 11.1 support (optional but recommended for GPU acceleration).
- Internet connection for downloading dependencies and models.

## Installation

### 1. Clone the Repository
```bash
git clone <repository-url>
cd <repository-directory>
```

### 2. Build the Docker Image
The project uses a `Dockerfile` to create a containerized environment. Build the image with the following command:
```bash
docker build -t my_vit_env .
```

### 3. Verify Installation
Ensure the image is built successfully by listing Docker images:
```bash
docker images
```

## Usage

### 1. Run the Container
Launch the container and map port 8888 to access Jupyter Notebook:
```bash
docker run -p 8888:8888 my_vit_env
```

- **With GPU Support**: If you have an NVIDIA GPU, run with GPU acceleration:
  ```bash
  docker run --gpus all -p 8888:8888 my_vit_env
  ```

### 2. Access Jupyter Notebook
- Open your web browser and navigate to: `http://localhost:8888`.
- A token will be displayed in the container logs. Copy and paste it into the Jupyter login page to access the notebook.

### 3. Working with Notebooks
- The container includes pre-installed Jupyter kernels and libraries listed in `requirements.txt`.
- Edit and run the provided `.ipynb` files (e.g., `api_edit_mass.ipynb`, `api_mass.ipynb`) within the Jupyter interface.

## Project Structure
- `ckpts/`: Directory for model checkpoints.
- `configs/`: Configuration files.
- `datasets/`: Dataset storage.
- `models/`: Model files and configurations.
- `Output/`: Output files generated by the project.
- `Dockerfile`: Configuration for the Docker environment.
- `requirements.txt`: List of Python dependencies.

## Dependencies
All dependencies are managed via `requirements.txt`. Key libraries include:
- **PyTorch**: `torch==1.8.1+cu111`, `torchvision==0.9.1+cu111`
- **TensorFlow/Keras**: `tensorflow==1.13.1`, `keras==2.2.4`
- **Jupyter**: `jupyter`, `notebook`, `ipykernel`
- **Image Processing**: `scikit-image==0.16.2`, `mmcv-full==1.3.0`
- **Web/API**: `fastapi`, `flask==1.1.1`, `uvicorn`

To update or add dependencies, edit `requirements.txt` and rebuild the Docker image.

## Model Setup
Certain models are required for the project. Download and place them in the appropriate directories:
- **SAM Model**: Download `sam_vit_h_4b8939.pth` from [here](https://mega.nz/file/npIlkBCQ#J7xP9Bz_dH-0vDVk0UvX1eQ5mgRLc0tz44PtcCZEwrc) and place it in `ckpts/`.
- **SETR_MLA Model**: Download `iter_80000.pth` from [here](https://mega.nz/file/OgIHmLpS#bT6e5X78zB6jxVWeUd_BYffof9WL7C5wJ5UpxEJzKM0) and place it in `ckpts/SETR_MLA/`.
- **MonoVideo Models**: Download `monovideo_fine_tune_food_videos.h5` from [here](https://mega.nz/file/7sBDSTaT#jnKvMdXl-q6qQW-l4k7MxKov93_lEqKjK8Vr47Kcmec) and `monovideo_fine_tune_food_videos.json` from [here](https://mega.nz/file/SgJkTbwa#tKL3RCHvxeTp7aWtbP5qxB13F8CT0KwPtVKdwNst6q4), then place both in `models/fine_tune_food_videos/`.

**Note**: Use a Mega.nz downloader or browser extension to access these files.

## Troubleshooting
- **Jupyter Token Issue**: If the token is not displayed, check the container logs with `docker logs <container-id>`.
- **GPU Not Detected**: Ensure NVIDIA drivers and the NVIDIA Container Toolkit are installed on your host machine.
- **Dependency Conflicts**: Rebuild the image after updating `requirements.txt`.

## Contributing
Feel free to submit issues or pull requests on the GitHub repository. Please include detailed descriptions of changes.

## License
[Specify your license here, e.g., MIT, Apache 2.0, or proprietary] - Update this section as needed.

## Contact
For support, reach out via [your email or contact method].
